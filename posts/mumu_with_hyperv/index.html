<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta itemprop=name content="Mumu 模拟器 & WSL2，双倍的快乐"><meta itemprop=description content="第一次有了最香的 WSL2，有了好用的 Mumu 模拟器，两件快乐事情重合在一起，而这两份快乐，又给我带来更多的快乐。得到的，本该是像梦境一般幸福的时间"><meta itemprop=datePublished content="2020-05-21T23:09:18+08:00"><meta itemprop=dateModified content="2020-05-22T13:28:49+08:00"><meta itemprop=wordCount content="1494"><meta itemprop=image content="https://avatars0.githubusercontent.com/u/9512067"><meta itemprop=keywords content="杂谈,"><meta property="og:title" content="Mumu 模拟器 & WSL2，双倍的快乐"><meta property="og:description" content="第一次有了最香的 WSL2，有了好用的 Mumu 模拟器，两件快乐事情重合在一起，而这两份快乐，又给我带来更多的快乐。得到的，本该是像梦境一般幸福的时间"><meta property="og:type" content="article"><meta property="og:url" content="https://simonsmh.cc/posts/mumu_with_hyperv/"><meta property="og:image" content="https://avatars0.githubusercontent.com/u/9512067"><meta property="article:published_time" content="2020-05-21T23:09:18+08:00"><meta property="article:modified_time" content="2020-05-22T13:28:49+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://avatars0.githubusercontent.com/u/9512067"><meta name=twitter:title content="Mumu 模拟器 & WSL2，双倍的快乐"><meta name=twitter:description content="第一次有了最香的 WSL2，有了好用的 Mumu 模拟器，两件快乐事情重合在一起，而这两份快乐，又给我带来更多的快乐。得到的，本该是像梦境一般幸福的时间"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>Mumu 模拟器 & WSL2，双倍的快乐</title><link rel=stylesheet href=https://simonsmh.cc/css/style.min.82268888c72fd57d524ca9e40211409d3353c72a26aff636ebcda2d1b8163450.css integrity="sha256-giaIiMcv1X1STKnkAhFAnTNTxyomr/Y2682i0bgWNFA=" crossorigin=anonymous><link rel=stylesheet href=https://simonsmh.cc/css/custom.css></head><body id=page><header id=site-header class="animated slideInUp faster"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://simonsmh.cc/>simonsmh - 后花园</a></div><nav class="site-nav hide-in-mobile"><a href=https://simonsmh.cc/posts>文章</a>
<a href=https://simonsmh.cc/friendlinks>友链</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=mailto:simonsmh@gmail.com target=_blank rel="noopener me" title=Email><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a href=https://twitter.com/simonsmhsmh target=_blank rel="noopener me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://github.com/simonsmh target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://t.me/simonsmh target=_blank rel="noopener me" title=Telegram><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.198 2.433a2.242 2.242.0 00-1.022.215l-8.609 3.33c-2.068.8-4.133 1.598-5.724 2.21a405.15 405.15.0 01-2.849 1.09c-.42.147-.99.332-1.473.901-.728.968.193 1.798.919 2.286 1.61.516 3.275 1.009 4.654 1.472.509 1.793.997 3.592 1.48 5.388.16.36.506.494.864.498l-.002.018s.281.028.555-.038a2.1 2.1.0 00.933-.517c.345-.324 1.28-1.244 1.811-1.764l3.999 2.952.032.018s.442.311 1.09.355c.324.022.75-.04 1.116-.308.37-.27.613-.702.728-1.196.342-1.492 2.61-12.285 2.997-14.072l-.01.042c.27-1.006.17-1.928-.455-2.474a1.654 1.654.0 00-1.034-.407z"/></svg></a></span><button id=menu-btn class=hdr-btn title=菜单><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://simonsmh.cc/posts>文章</a></li><li><a href=https://simonsmh.cc/friendlinks>友链</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>May 21, 2020</span></div><h1>Mumu 模拟器 & WSL2，双倍的快乐</h1></header><div class=content><blockquote><p>第一次有了最香的 WSL2，有了好用的 Mumu 模拟器，两件快乐事情重合在一起，而这两份快乐，又给我带来更多的快乐。得到的，本该是像梦境一般幸福的时间……</p></blockquote><h2 id=国产手游模拟器与-hyper-v-之争>国产手游模拟器与 Hyper-V 之争<a href=#国产手游模拟器与-hyper-v-之争 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Mumu 是一款商业化的 Android X86 手游模拟器，其运行手游的效率相对较高，体验尚佳，我曾经常使用，但是由于其无法与 Hyper-V 共存，便一直在寻找替代品。事实上，基本所有的模拟器都是基于开源的 Virtualbox 进行魔改提升效率，实现 Direct3D 11 渲染，完善用户体验，但是其基本的需求都是使用魔改 Virtualbox 自己的后端实现而达到的，自然从原理上就无法与 Hyper-V 兼容。</p><p>这在旧时 Windows 时期，其实是件大快人心的好事，毕竟 Hyper-V 其运行效率难以与传统的虚拟机平台 Vmware、Virtualbox 竞争，也被吐过不少口水。不巧的是 Hyper-V 近年来用处是越来越多了，从一键开发虚拟环境搭建，到 Container，到 Windows Sandbox，一直到 WSL2 宣布使用 Hyper-V+Linux Kernel 方案替代 WSL1 的 Windows NT API 方案，日常的生活是越来越绕不开 Hyper-V 了。当然，强制让 Virtualbox 使用 Hyper-V 后端的解决方案也有，但是性能就比较难以令人接受，感兴趣可以通过修改 Genymotion 附带的 Virtualbox 配置来尝试（scrcpy 在高分屏上可能有性能问题）。</p><h2 id=写作-nebula读作-windroy>写作 Nebula，读作 Windroy?<a href=#写作-nebula读作-windroy class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>2020 年初，Mumu 手游助手测试版于网易 Mumu 官网推出，其与原版 Mumu 模拟器最不相同的地方就是在于其在原版引擎 Nemu 的基础上添加了一个新引擎 Nebula，其原理上就不同于传统的 Virtualbox，它不是跑在 Linux Kernel 之上，而是直接跑在 Windows Kernel 上，换句话说，其实现了 Windows API 与 Android API 的桥接与翻译。第一眼看见它时，我第一个想到的就是 6 年之前的 Bluestacks 和 <a href=http://web.archive.org/web/20141006160302/http://www.windroy.cn/>Windroy</a> 这两款特立独行的 Windows 平台 Android X86 兼容软件，依赖其出色的 <a href=https://source.android.com/devices/tech/dalvik>Dalvik</a> 性能而脱颖而出，但可惜的是这两款软件后来放弃了这个方向，带领行业纷纷转用虚拟机实现。</p><p><img src=https://i.loli.net/2020/05/22/UrZSAH4y6aquojv.png alt=image.png></p><p>下载试用 Nebula 星云引擎，果然因为其原理的不同，其启动速度飞快，反应迅速，界面也非常“熟悉”，是“家”一般的感觉——最后一版支持 Dalvik 运行时的 Android 4.4 KitKat，而与之相对的是 Nemu 标准引擎带来的 Android 6.0 Marshmallow。由于 Hyper-V 的冲突和限制，Nemu 引擎启动时就会触发 Windows 蓝屏，而 Nebula 就可以毫无压力的进行使用，且游戏性能确实优于 Nemu，运行游戏极少掉帧。</p><p><img src=https://i.loli.net/2020/05/22/kwPbA1gVMzGCK7n.png alt=image.png></p><p>相对运行完整虚拟机来说，在运行舟游等低负载压力的 Unity 游戏情况下显卡占用还是比较低的，体验可以说是相当不错了。</p><p><img src=https://i.loli.net/2020/05/22/Th1RPyz5iLgSvBr.png alt=image.png></p><p>虚拟机虽然跑不了 adbd，没有 Root，但是自带 Busybox 提供了一个 Root Shell 接口在
<code>.\MuMu\mumu3\Engine\NEBULA\NEBULA-&lt;version>-x86\sh.bat</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>nebula<span class=se>\n</span>ebula.exe --cooked-mode --rootdir nebula/fs_static --session-id *** --dynamicdir *** /system/bin/sh 
</code></pre></td></tr></table></div></div><p>其中 <code>dynamicdir</code> 就是系统之外数据的部分，似乎每个软件都应当有独立的空间，而引擎在使用的时候按需挂载。</p><p>Mumu 限制了通过 GUI 为 Nebula 安装自己的软件包，但是可以通过这个接口使用命令行安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>pm install -f *.apk
</code></pre></td></tr></table></div></div><p>当然，因为其是 Dalvik，没有 dex2oat 的步骤， 直接拷贝至 <code>/data/app</code> 后重启也是可以的。</p><p>我也尝试着拷贝了一份台服公主连结的 APK，不管是游戏引继还是资源包下载安装都没有遇到什么障碍，由于模拟器可以锁渲染 120 帧，很多地方都比手机要更加流畅。</p><p>然而，在 2020 年的今天，寻找 MinSDK&lt;=19 的软件早就已经不是件容易事，日新月异的的 API 吸引着更多的应用开发者逐步抛弃低市占率的平台已是既成事实，但好在游戏行业大多不受其限制，毕竟更多的用户往往意味着更多的收入，这也是为什么如此低的 API 版本依然使 Nebula 对使用 Hyper-V 的手游玩家来说值得一用。</p><h2 id=结语与展望>结语与展望<a href=#结语与展望 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Windows 的子系统和容器的发展在近些年开始对消费者产生了难以抵抗的吸引力，但由于其与开源开放的 Linux 平台容器技术不同，以及 Android 平台本身就基于 Linux 内核开发，类似 Anbox 的容器应用曾经几乎不可能在 Windows 平台出现。今年的微软 Build 大会之上，微软首次展示了 WSL 与 GPU 的交互，展示了 WSL 平台的 GUI 应用，这或许意味着 Anbox 也可以通过 WSL 的 GPU 进行渲染，而不再需要额外的模拟器（当然，效率究竟几何仍需打个问号），又或许将来某一天 Project Astoria 就能以这种身份复活在 Windows Shell Experience 中。</p></div><div class="related-posts thin"><h2>相关推荐</h2><ul><li><a href=/posts/migrate-to-hugo/>迁移至 Hugo</a></li><li><a href=/posts/ticwatch_play_around/>玩耍 TicWatch C2</a></li><li><a href=/posts/arch_lineage/>在 Arch Linux 上编译 Lineage 15.1 和 TWRP</a></li><li><a href=/posts/exview%E8%BD%A6%E7%89%8C%E7%A0%94%E7%A9%B6/>Exview 车牌研究</a></li><li><a href=/posts/android_%E5%8E%BB%E5%8F%B9%E5%8F%B7/>android 去叹号</a></li></ul></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://simonsmh.cc/tags/%E6%9D%82%E8%B0%88>杂谈</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1494 字</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2020-05-21 15:09 +0000</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=https://github.com/simonsmh/simonsmh.github.io/commit/c314d17e17ba658dfa35ae2624ed8f6f652de3e6 target=_blank rel=noopener>c314d17</a> @ 2020-05-22</p></footer></article><div class="post-nav thin"><a class=prev-post href=https://simonsmh.cc/posts/migrate-to-hugo/><span class=post-nav-label>旧&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>迁移至 Hugo</span></a></div><div id=comments class=thin><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"simonsmh"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2020 <a href=https://simonsmh.cc/>Simon Shi</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://simonsmh.cc/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://simonsmh.cc/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-73742380-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>